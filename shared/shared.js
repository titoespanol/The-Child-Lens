!function(){"use strict";const e=document.documentElement,t=document.getElementById("accentSelect"),o=document.getElementById("darkToggle"),n=document.getElementById("audienceSelect"),c=document.getElementById("ageSelect"),s=document.getElementById("sidebar"),r=document.getElementById("sidebarToggle"),d=document.getElementById("scrollProgress"),i=document.getElementById("copyToast"),a={accent:"childlens-accent",theme:"childlens-theme",audience:"childlens-audience",age:"childlens-age",reduceMotion:"childlens-reduce-motion"};function l(e,t){try{localStorage.setItem(e,t)}catch(e){}}function u(e){try{return localStorage.getItem(e)}catch(e){return null}}function m(t){e.style.setProperty("--accent",t),e.style.setProperty("--accent-soft","color-mix(in srgb, "+t+" 15%, var(--color-cream))"),e.style.setProperty("--accent-medium","color-mix(in srgb, "+t+" 40%, var(--color-cream))"),e.style.setProperty("--accent-contrast","color-mix(in srgb, "+t+" 100%, #000 30%)"),e.style.setProperty("--accent-muted","color-mix(in srgb, "+t+" 25%, var(--color-cream))")}!function(){const s=u(a.accent),r=u(a.theme),d=u(a.audience),i=u(a.age),l=u(a.reduceMotion);if(s&&t){m(s),t.value=s;const e=t.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");e&&e.forEach(e=>{if(e.classList.remove("selected"),e.dataset.value===s){e.classList.add("selected");const o=t.closest(".custom-dropdown")?.querySelector(".dd-label");o&&(o.textContent=e.textContent.trim())}})}if("dark"===r&&(e.setAttribute("data-theme","dark"),o)){const e=o.querySelector(".toggle-icon");e&&(e.textContent="â˜€ï¸"),o.setAttribute("aria-pressed","true")}if(d&&n){e.setAttribute("data-audience",d),n.value=d;const t=n.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");t&&t.forEach(e=>{if(e.dataset.value===d){e.classList.add("selected");const t=n.closest(".custom-dropdown")?.querySelector(".dd-label");t&&(t.textContent=e.textContent.trim())}})}if(i&&c){e.setAttribute("data-age",i),c.value=i;const t=c.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");t&&t.forEach(e=>{if(e.dataset.value===i){e.classList.add("selected");const t=c.closest(".custom-dropdown")?.querySelector(".dd-label");t&&(t.textContent=e.textContent.trim())}})}if("true"===l){e.setAttribute("data-reduce-motion","true");const t=document.getElementById("reduceMotionToggle");t&&t.setAttribute("aria-pressed","true")}}(),t&&t.addEventListener("change",function(){const t=this.value;m(t),l(a.accent,t),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),o&&o.addEventListener("click",function(){"dark"===e.getAttribute("data-theme")?(e.setAttribute("data-theme","light"),this.querySelector(".toggle-icon").textContent="ðŸŒ™",this.setAttribute("aria-pressed","false"),l(a.theme,"light")):(e.setAttribute("data-theme","dark"),this.querySelector(".toggle-icon").textContent="â˜€ï¸",this.setAttribute("aria-pressed","true"),l(a.theme,"dark"))});if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){e.setAttribute("data-reduce-motion","true");const t=document.getElementById("reduceMotionToggle");t&&t.setAttribute("aria-pressed","true")}const g=document.getElementById("reduceMotionToggle");g&&g.addEventListener("click",function(){const t="true"===e.getAttribute("data-reduce-motion");e.setAttribute("data-reduce-motion",t?"false":"true"),this.setAttribute("aria-pressed",String(!t)),l(a.reduceMotion,!t),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),n&&n.addEventListener("change",function(){e.setAttribute("data-audience",this.value),l(a.audience,this.value),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),c&&c.addEventListener("change",function(){e.setAttribute("data-age",this.value),l(a.age,this.value),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))});const h=s?s.querySelectorAll(".sidebar-link"):[];function p(){const e=document.querySelectorAll("section[id]");let t="";e.forEach(e=>{e.getBoundingClientRect().top<=120&&(t=e.id)}),h.forEach(e=>{e.classList.toggle("active",e.getAttribute("href")==="#"+t)})}function y(){if(!d)return;const e=document.documentElement.scrollHeight-window.innerHeight;d.style.width=e>0?window.scrollY/e*100+"%":"0%"}r&&s&&r.addEventListener("click",()=>s.classList.toggle("open")),s&&s.addEventListener("click",function(e){e.target.classList.contains("sidebar-link")&&window.innerWidth<=960&&s.classList.remove("open")});let v=!1;function E(e){i&&(i.textContent=e||"Copied!",i.classList.add("show"),setTimeout(()=>i.classList.remove("show"),1800))}function f(){const t=document.querySelectorAll(".media-backdrop__media--video"),o="true"===e.getAttribute("data-reduce-motion");t.forEach(function(e){o?e.pause():e.autoplay&&e.play().catch(function(){})})}window.addEventListener("scroll",function(){v||(requestAnimationFrame(()=>{p(),y(),v=!1}),v=!0)}),p(),y(),document.addEventListener("click",function(e){const t=e.target.closest("[data-copy]");if(!t)return;const o=t.getAttribute("data-copy");if(navigator.clipboard)navigator.clipboard.writeText(o).then(()=>E());else{const e=document.createElement("textarea");e.value=o,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),E()}}),document.querySelectorAll(".custom-dropdown").forEach(e=>{const t=e.querySelector(".custom-dropdown-trigger"),o=e.querySelector(".custom-dropdown-menu"),n=e.querySelectorAll(".custom-dropdown-option"),c=e.querySelector("select")||e.querySelector('input[type="hidden"]');t&&o&&(t.addEventListener("click",function(e){e.stopPropagation(),document.querySelectorAll(".custom-dropdown-menu.open").forEach(e=>{e!==o&&e.classList.remove("open")}),o.classList.toggle("open")}),n.forEach(e=>{e.addEventListener("click",function(e){e.stopPropagation();const s=this.dataset.value,r=this.textContent.trim();t.querySelector(".dd-label").textContent=r,n.forEach(e=>e.classList.remove("selected")),this.classList.add("selected"),o.classList.remove("open"),c&&(c.value=s,c.dispatchEvent(new Event("change")))})}),t.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click()),"Escape"===e.key&&o.classList.remove("open")}))}),document.addEventListener("click",()=>{document.querySelectorAll(".custom-dropdown-menu.open").forEach(e=>e.classList.remove("open"))}),f(),e.addEventListener("childlens:settings-changed",f),window.childLensShared={showToast:E,root:e,persistSetting:l,loadSetting:u,LS_KEYS:a,checkBackdropVideos:f}}();