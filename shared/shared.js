!function(){"use strict";const e=document.documentElement,t=document.getElementById("accentSelect"),n=document.getElementById("darkToggle"),o=document.getElementById("audienceSelect"),i=document.getElementById("ageSelect"),s=document.getElementById("sidebar"),c=document.getElementById("sidebarToggle"),r=document.getElementById("scrollProgress"),a=document.getElementById("copyToast"),l={accent:"childlens-accent",theme:"childlens-theme",audience:"childlens-audience",age:"childlens-age",reduceMotion:"childlens-reduce-motion"};function d(e,t){try{localStorage.setItem(e,t)}catch(e){}}function u(e){try{return localStorage.getItem(e)}catch(e){return null}}function m(t){e.style.setProperty("--accent",t),e.style.setProperty("--accent-soft","color-mix(in srgb, "+t+" 15%, var(--color-cream))"),e.style.setProperty("--accent-medium","color-mix(in srgb, "+t+" 40%, var(--color-cream))"),e.style.setProperty("--accent-contrast","color-mix(in srgb, "+t+" 100%, #000 30%)"),e.style.setProperty("--accent-muted","color-mix(in srgb, "+t+" 25%, var(--color-cream))")}!function(){const s=u(l.accent),c=u(l.theme),r=u(l.audience),a=u(l.age),d=u(l.reduceMotion);if(s&&t){m(s),t.value=s;const e=t.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");e&&e.forEach(e=>{if(e.classList.remove("selected"),e.dataset.value===s){e.classList.add("selected");const n=t.closest(".custom-dropdown")?.querySelector(".dd-label");n&&(n.textContent=e.textContent.trim())}})}if("dark"===c&&(e.setAttribute("data-theme","dark"),n)){const e=n.querySelector(".toggle-icon");e&&(e.textContent="â˜€ï¸"),n.setAttribute("aria-pressed","true")}if(r&&o){e.setAttribute("data-audience",r),o.value=r;const t=o.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");t&&t.forEach(e=>{if(e.dataset.value===r){e.classList.add("selected");const t=o.closest(".custom-dropdown")?.querySelector(".dd-label");t&&(t.textContent=e.textContent.trim())}})}if(a&&i){e.setAttribute("data-age",a),i.value=a;const t=i.closest(".custom-dropdown")?.querySelectorAll(".custom-dropdown-option");t&&t.forEach(e=>{if(e.dataset.value===a){e.classList.add("selected");const t=i.closest(".custom-dropdown")?.querySelector(".dd-label");t&&(t.textContent=e.textContent.trim())}})}if("true"===d){e.setAttribute("data-reduce-motion","true");const t=document.getElementById("reduceMotionToggle");t&&t.setAttribute("aria-pressed","true")}}(),t&&t.addEventListener("change",function(){const t=this.value;m(t),d(l.accent,t),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),n&&n.addEventListener("click",function(){"dark"===e.getAttribute("data-theme")?(e.setAttribute("data-theme","light"),this.querySelector(".toggle-icon").textContent="ðŸŒ™",this.setAttribute("aria-pressed","false"),d(l.theme,"light")):(e.setAttribute("data-theme","dark"),this.querySelector(".toggle-icon").textContent="â˜€ï¸",this.setAttribute("aria-pressed","true"),d(l.theme,"dark"))});if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){e.setAttribute("data-reduce-motion","true");const t=document.getElementById("reduceMotionToggle");t&&t.setAttribute("aria-pressed","true")}const g=document.getElementById("reduceMotionToggle");g&&g.addEventListener("click",function(){const t="true"===e.getAttribute("data-reduce-motion");e.setAttribute("data-reduce-motion",t?"false":"true"),this.setAttribute("aria-pressed",String(!t)),d(l.reduceMotion,!t),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),o&&o.addEventListener("change",function(){e.setAttribute("data-audience",this.value),d(l.audience,this.value),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))}),i&&i.addEventListener("change",function(){e.setAttribute("data-age",this.value),d(l.age,this.value),e.dispatchEvent(new CustomEvent("childlens:settings-changed"))});var v="";function h(e){e!==v&&(v=e,(s?s.querySelectorAll(".sidebar-link"):[]).forEach(function(t){t.classList.toggle("active",t.getAttribute("href")==="#"+e)}))}function f(){if(r){var e=document.documentElement.scrollHeight-window.innerHeight;r.style.width=e>0?window.scrollY/e*100+"%":"0%"}}!function(){var e=document.querySelectorAll("section[id]");if(e.length)if("IntersectionObserver"in window){var t=new Map,n=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting?t.set(e.target.id,e.boundingClientRect.top):t.delete(e.target.id)});var n="",o=1/0;t.forEach(function(e,t){var i=document.getElementById(t);if(i){var s=i.getBoundingClientRect().top;s<=150&&s>.5*-window.innerHeight&&s<o&&(o=s,n=t)}}),!n&&t.size>0&&t.forEach(function(e,t){n||(n=t)}),n&&h(n)},{rootMargin:"-60px 0px -40% 0px",threshold:0});e.forEach(function(e){n.observe(e)})}else window.addEventListener("scroll",function(){var t="";e.forEach(function(e){e.getBoundingClientRect().top<=120&&(t=e.id)}),h(t)})}(),c&&s&&!document.getElementById("sidebarOverlay")&&(c.addEventListener("click",function(){s.classList.toggle("open")}),s.addEventListener("click",function(e){e.target.classList.contains("sidebar-link")&&window.innerWidth<=960&&s.classList.remove("open")}));var p=document.querySelector(".global-header"),y=!1;function E(e){a&&(a.textContent=e||"Copied!",a.classList.add("show"),setTimeout(()=>a.classList.remove("show"),1800))}function b(){const t=document.querySelectorAll(".media-backdrop__media--video"),n="true"===e.getAttribute("data-reduce-motion");t.forEach(function(e){n?e.pause():e.autoplay&&e.play().catch(function(){})})}window.addEventListener("scroll",function(){y||(requestAnimationFrame(function(){f(),p&&p.classList.toggle("scrolled",window.scrollY>10),y=!1}),y=!0)}),f(),function(){if("IntersectionObserver"in window)if("true"!==e.getAttribute("data-reduce-motion")){var t=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&(e.target.classList.add("is-visible"),t.unobserve(e.target))})},{rootMargin:"0px 0px -80px 0px",threshold:.01});document.querySelectorAll(".card, .doctrine, .callout, .ecosystem-card, .do-dont-card, .metric-card, .pattern-detail, .data-table, .scorecard").forEach(function(e){e.classList.contains("reveal")||e.classList.contains("is-visible")||e.classList.contains("section-header")||e.classList.add("reveal")}),document.querySelectorAll(".ecosystem-grid, .do-dont-grid, .metrics-grid, .doctrines-grid").forEach(function(e){e.classList.add("reveal-stagger")});var n=document.querySelectorAll(".reveal, .section-header");n.forEach(function(e){t.observe(e)}),requestAnimationFrame(function(){n.forEach(function(e){if(!e.classList.contains("is-visible")){var n=e.getBoundingClientRect();n.top<window.innerHeight&&n.bottom>0&&(e.classList.add("is-visible"),t.unobserve(e))}})}),e.addEventListener("childlens:settings-changed",function(){"true"===e.getAttribute("data-reduce-motion")&&document.querySelectorAll(".reveal, .section-header").forEach(function(e){e.classList.add("is-visible")})})}else document.querySelectorAll(".reveal, .section-header").forEach(function(e){e.classList.add("is-visible")});else document.querySelectorAll(".reveal, .section-header").forEach(function(e){e.classList.add("is-visible")})}(),s&&s.querySelectorAll(".sidebar-group").forEach(function(e){var t=e.querySelector(".sidebar-group-header"),n=e.querySelector(".sidebar-group-items");t&&n&&(n.style.maxHeight=n.scrollHeight+"px",t.addEventListener("click",function(){e.classList.contains("collapsed")?(e.classList.remove("collapsed"),t.setAttribute("aria-expanded","true"),n.style.maxHeight=n.scrollHeight+"px"):(e.classList.add("collapsed"),t.setAttribute("aria-expanded","false"))}))}),function(){var e=document.getElementById("sidebarSearch"),t=document.getElementById("sidebarSearchClear"),n=document.getElementById("sidebarNoResults");if(e&&s){var o=s.querySelectorAll(".sidebar-link"),i=[];o.forEach(function(e){i.push({el:e,text:e.textContent.trim().toLowerCase(),originalHTML:e.innerHTML})}),e.addEventListener("input",function(){r(this.value)}),t&&t.addEventListener("click",function(){e.value="",e.focus(),r("")}),e.addEventListener("keydown",function(e){"Escape"===e.key&&(this.value="",r(""),this.blur())})}function c(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}function r(e){e=e.toLowerCase().trim();var t=0;i.forEach(function(n){if(!e)return n.el.style.display="",n.el.innerHTML=n.originalHTML,void t++;if(-1!==n.text.indexOf(e)){n.el.style.display="";var o=n.el.querySelector(".sidebar-link-icon"),i=o?o.outerHTML:"",s=n.el.textContent.trim(),r=s.toLowerCase().indexOf(e);if(-1!==r){var a=s.substring(0,r),l=s.substring(r,r+e.length),d=s.substring(r+e.length);n.el.innerHTML=i+c(a)+"<mark>"+c(l)+"</mark>"+c(d)}t++}else n.el.style.display="none"}),s.querySelectorAll(".sidebar-group").forEach(function(t){var n=t.querySelector(".sidebar-group-items");if(n){var o=!1;if(n.querySelectorAll(".sidebar-link").forEach(function(e){"none"!==e.style.display&&(o=!0)}),e&&!o)t.style.display="none";else if(t.style.display="",e&&t.classList.contains("collapsed")){t.classList.remove("collapsed");var i=t.querySelector(".sidebar-group-header");i&&i.setAttribute("aria-expanded","true"),n&&(n.style.maxHeight=n.scrollHeight+"px")}}}),n&&(n.style.display=e&&0===t?"block":"none")}}(),document.addEventListener("click",function(e){const t=e.target.closest("[data-copy]");if(!t)return;const n=t.getAttribute("data-copy");if(navigator.clipboard)navigator.clipboard.writeText(n).then(()=>E());else{const e=document.createElement("textarea");e.value=n,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),E()}}),document.querySelectorAll(".custom-dropdown").forEach(e=>{const t=e.querySelector(".custom-dropdown-trigger"),n=e.querySelector(".custom-dropdown-menu"),o=e.querySelectorAll(".custom-dropdown-option"),i=e.querySelector("select")||e.querySelector('input[type="hidden"]');t&&n&&(t.addEventListener("click",function(e){e.stopPropagation(),document.querySelectorAll(".custom-dropdown-menu.open").forEach(e=>{e!==n&&e.classList.remove("open")}),n.classList.toggle("open")}),o.forEach(e=>{e.addEventListener("click",function(e){e.stopPropagation();const s=this.dataset.value,c=this.textContent.trim();t.querySelector(".dd-label").textContent=c,o.forEach(e=>e.classList.remove("selected")),this.classList.add("selected"),n.classList.remove("open"),i&&(i.value=s,i.dispatchEvent(new Event("change")))})}),t.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click()),"Escape"===e.key&&n.classList.remove("open")}))}),document.addEventListener("click",()=>{document.querySelectorAll(".custom-dropdown-menu.open").forEach(e=>e.classList.remove("open"))}),b(),e.addEventListener("childlens:settings-changed",b);const L=document.getElementById("sidebarOverlay");c&&s&&L&&(c.addEventListener("click",function(){const e=s.classList.toggle("open");L.classList.toggle("visible",e)}),L.addEventListener("click",function(){s.classList.remove("open"),L.classList.remove("visible")}),s.addEventListener("click",function(e){e.target.classList.contains("sidebar-link")&&window.innerWidth<=960&&(s.classList.remove("open"),L.classList.remove("visible"))})),window.childLensShared={showToast:E,root:e,persistSetting:d,loadSetting:u,LS_KEYS:l,checkBackdropVideos:b,initLiquidNav:function(e){if(e){var t=e.classList.contains("pattern-phone-nav")?".pattern-phone-nav-item":".nav-bottom-item";e.addEventListener("click",function(n){var o=n.target.closest(t);o&&!o.classList.contains("active")&&(e.querySelectorAll(t).forEach(function(e){e.classList.remove("active")}),o.classList.add("active"))})}}}}();